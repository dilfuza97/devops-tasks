{
    "builders": [
      {
        "type": "googlecompute",
        "project_id": "packer-and-g-213-91cba046",
        "account_file": "account.json",
        "source_image_family": "ubuntu-2004-lts",
        "zone": "us-central1-f",
        "ssh_username": "root",
        "image_name": "booksite-packer",
        "image_description": "Web server for book application landing page",
        "image_labels": {
            "role": "web",
            "team": "frontend"
        }
    }
],
"provisioners": [
    {
        "type": "shell",
        "inline": [
            "sudo apt-get update -y && sudo apt-get upgrade -y",
            "sudo apt install python -y"
        ]
    },
    {
        "type": "ansible",
        "playbook_file": "/home/ubuntu/playbook.yml",
        "group": ["web"]
    },
    {
        command = "ansible-playbook"
        playbook_file = "pre_build_controller.yml"
        user = "ec2-user"
        inventory_file_template = "controller ansible_host={{ .Host }} ansible_user={{ .User }} ansible_port={{ .Port }}\n"
        extra_arguments = local.extra_args
    }
    
]
}

